.page-header
  %h1
    =@cart_item.dvd.name
= form_for @cart_item do |f|
  =f.hidden_field :dvd_id
  =f.hidden_field :status
  - if @cart_item.errors.any?
    #error_explanation
      %h2= "Невозможно продолжить, так как:"
      %ul
        - @cart_item.errors.full_messages.each do |msg|
          %li= msg

  .row
    .col-md-3
      -if @cart_item.dvd.cover?
        =image_tag @cart_item.dvd.cover.url(:medium), alt: @cart_item.dvd.name, class: 'img-responsive'
    .col-md-9
      %dl
      -if @cart_item.price
        %dt='Цена'
        %small.text-muted=@cart_item.price
        %small.text-muted руб
      -if @cart_item.dvd.film.name
        %dt='Фильм'
        %dd=link_to @cart_item.dvd.film.name, @cart_item.dvd.film
      -if @cart_item.dvd.cover_type
        %dt="Тип обложки"
        %dd=@cart_item.dvd.cover_type
    .col-md-2
      -if @cart_item.status == 1
        .form-group
          =f.label :Количество
          =f.number_field :amount, class: 'form-control'
      -if not @cart_item.status 
        .form-group
          =f.label :Количество
          =f.number_field :amount, class: 'form-control'
      .form-group
        =f.label :Тип_доставки
        =f.select :type_of_delivery, CartItem::DELIVERY.map.with_index{|name,i| [name,i]}, {},class: 'form-control'
      .form-group
        =f.label :Адрес_доставки
        =f.text_field :address, class: 'form-control'

      -if @cart_item.status
        %dt='Статус'
        -if @cart_item.status == 1
          %small.text-muted  Ожидается оплата
        -if @cart_item.status == 2
          %small.text-muted  Оплачено
        -if @cart_item.status == 3
          %small.text-muted  Доставляется
        -if @cart_item.status == 4
          %small.text-muted  Доставлено
  %br
  .row
    .col-md-4
      .btn-toolbar
        = f.submit 'Готово', class: 'btn btn-danger'
        %br
